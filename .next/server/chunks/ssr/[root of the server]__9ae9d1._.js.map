{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/boomthmac/Desktop/kobdemy/nextjs15-basic/src/app/register/RegisterForm.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/register/RegisterForm.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/register/RegisterForm.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAAqS,GAClU,mEACA"}},
    {"offset": {"line": 15, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 21, "column": 0}, "map": {"version":3,"sources":["file:///Users/boomthmac/Desktop/kobdemy/nextjs15-basic/src/app/register/RegisterForm.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/register/RegisterForm.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/register/RegisterForm.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAAiR,GAC9S,+CACA"}},
    {"offset": {"line": 29, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 35, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 39, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 45, "column": 0}, "map": {"version":3,"sources":["file:///Users/boomthmac/Desktop/kobdemy/nextjs15-basic/src/app/register/page.tsx"],"sourcesContent":["import RegisterForm from './RegisterForm'\n\nconst RegisterPage = () => {\n  return <RegisterForm />\n}\nexport default RegisterPage\n"],"names":[],"mappings":";;;;AAAA;;;AAEA,MAAM,eAAe;IACnB,qBAAO,8OAAC,uIAAA,CAAA,UAAY;;;;;AACtB;uCACe"}},
    {"offset": {"line": 60, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 80, "column": 0}, "map": {"version":3,"sources":["file:///Users/boomthmac/Desktop/kobdemy/nextjs15-basic/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\n\nconst globalForPrisma = global as unknown as { prisma: PrismaClient };\n\nexport const prisma =\n  globalForPrisma.prisma || new PrismaClient();\n\nif (process.env.NODE_ENV !== \"production\") globalForPrisma.prisma = prisma;"],"names":[],"mappings":";;;AAAA;;AAEA,MAAM,kBAAkB;AAEjB,MAAM,SACX,gBAAgB,MAAM,IAAI,IAAI,6HAAA,CAAA,eAAY;AAE5C,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 94, "column": 0}, "map": {"version":3,"sources":["file:///Users/boomthmac/Desktop/kobdemy/nextjs15-basic/src/lib/schema.ts"],"sourcesContent":["import { z } from 'zod'\n\n// Define Constants\nconst MIN_NAME_LENGTH = 3\nconst MIN_PASSWORD_LENGTH = 8\nconst SPECIAL_CHARS = '!@#$%^&*(),.?\":{}|<>'\n\n// Define validation message\nconst ERROR_MESSAGES = {\n  name: `ชื่อต้องมีความยาวอย่างน้อย ${MIN_NAME_LENGTH} ตัวอักษร`,\n  email: {\n    format: 'กรุณากรอกอีเมลให้ถูกต้อง',\n    domain: 'อีเมลต้องเป็น Gmail, Hotmail, Outlook หรือ Yahoo'\n  },\n  password: {\n    length: `รหัสผ่านต้องมีความยาวอย่างน้อย ${MIN_PASSWORD_LENGTH} ตัวอักษร`,\n    uppercase: 'รหัสผ่านต้องมีตัวพิมพ์ใหญ่อย่างน้อย 1 ตัว',\n    lowercase: 'รหัสผ่านต้องมีตัวพิมพ์เล็กอย่างน้อย 1 ตัว',\n    number: 'รหัสผ่านต้องมีตัวเลขอย่างน้อย 1 ตัว',\n    special: `รหัสผ่านต้องมีตัวอักขระพิเศษ ${SPECIAL_CHARS} อย่างน้อย 1 ตัว`\n  },\n  confirmPassword: 'รหัสผ่านไม่ตรงกัน'\n}\n\n// Define valid email domain\nconst VALID_DOMAINS = [\n  'gmail.com',\n  'hotmail.com',\n  'outlook.com',\n  'yahoo.com'\n]\n\n// Email domain validation\nconst isValidEmailDomain = (email: string) => {\n  const domain = email ? email.split('@')[1].toLowerCase() : ''\n  return VALID_DOMAINS.includes(domain)\n}\n\n// Password validation schema\nconst passwordSchema = z.string()\n  .min(MIN_PASSWORD_LENGTH, { message: ERROR_MESSAGES.password.length })\n  .regex(/[A-Z]/, { message: ERROR_MESSAGES.password.uppercase })\n  .regex(/[a-z]/, { message: ERROR_MESSAGES.password.lowercase })\n  .regex(/[0-9]/, { message: ERROR_MESSAGES.password.number })\n  .regex(\n    new RegExp(`[${SPECIAL_CHARS}]`),\n    { message: ERROR_MESSAGES.password.special }\n  )\n\n// Main register schema\nexport const registerSchema = z.object({\n  name: z.string()\n    .optional()\n    .refine(\n      (name) => !name || name.length >= MIN_NAME_LENGTH,\n      { message: ERROR_MESSAGES.name }\n    ),\n\n  email: z.string()\n    .email({ message: ERROR_MESSAGES.email.format })\n    .refine(\n      (email) => isValidEmailDomain(email),\n      { message: ERROR_MESSAGES.email.domain }\n    ),\n\n  password: passwordSchema,\n  confirmPassword: z.string()\n}).refine(\n  (data) => data.password === data.confirmPassword,\n  {\n    message: ERROR_MESSAGES.confirmPassword,\n    path: ['confirmPassword']\n  }\n)\n\n// Main Login schema\nexport const loginSchema = z.object({\n  email: z.string()\n    .email({ message: ERROR_MESSAGES.email.format })\n    .refine(\n      (email) => isValidEmailDomain(email),\n      { message: ERROR_MESSAGES.email.domain }\n    ),\n\n  password: passwordSchema\n})"],"names":[],"mappings":";;;;AAAA;;AAEA,mBAAmB;AACnB,MAAM,kBAAkB;AACxB,MAAM,sBAAsB;AAC5B,MAAM,gBAAgB;AAEtB,4BAA4B;AAC5B,MAAM,iBAAiB;IACrB,MAAM,CAAC,2BAA2B,EAAE,gBAAgB,SAAS,CAAC;IAC9D,OAAO;QACL,QAAQ;QACR,QAAQ;IACV;IACA,UAAU;QACR,QAAQ,CAAC,+BAA+B,EAAE,oBAAoB,SAAS,CAAC;QACxE,WAAW;QACX,WAAW;QACX,QAAQ;QACR,SAAS,CAAC,6BAA6B,EAAE,cAAc,gBAAgB,CAAC;IAC1E;IACA,iBAAiB;AACnB;AAEA,4BAA4B;AAC5B,MAAM,gBAAgB;IACpB;IACA;IACA;IACA;CACD;AAED,0BAA0B;AAC1B,MAAM,qBAAqB,CAAC;IAC1B,MAAM,SAAS,QAAQ,MAAM,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,WAAW,KAAK;IAC3D,OAAO,cAAc,QAAQ,CAAC;AAChC;AAEA,6BAA6B;AAC7B,MAAM,iBAAiB,oIAAA,CAAA,IAAC,CAAC,MAAM,GAC5B,GAAG,CAAC,qBAAqB;IAAE,SAAS,eAAe,QAAQ,CAAC,MAAM;AAAC,GACnE,KAAK,CAAC,SAAS;IAAE,SAAS,eAAe,QAAQ,CAAC,SAAS;AAAC,GAC5D,KAAK,CAAC,SAAS;IAAE,SAAS,eAAe,QAAQ,CAAC,SAAS;AAAC,GAC5D,KAAK,CAAC,SAAS;IAAE,SAAS,eAAe,QAAQ,CAAC,MAAM;AAAC,GACzD,KAAK,CACJ,IAAI,OAAO,CAAC,CAAC,EAAE,cAAc,CAAC,CAAC,GAC/B;IAAE,SAAS,eAAe,QAAQ,CAAC,OAAO;AAAC;AAIxC,MAAM,iBAAiB,oIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;IACrC,MAAM,oIAAA,CAAA,IAAC,CAAC,MAAM,GACX,QAAQ,GACR,MAAM,CACL,CAAC,OAAS,CAAC,QAAQ,KAAK,MAAM,IAAI,iBAClC;QAAE,SAAS,eAAe,IAAI;IAAC;IAGnC,OAAO,oIAAA,CAAA,IAAC,CAAC,MAAM,GACZ,KAAK,CAAC;QAAE,SAAS,eAAe,KAAK,CAAC,MAAM;IAAC,GAC7C,MAAM,CACL,CAAC,QAAU,mBAAmB,QAC9B;QAAE,SAAS,eAAe,KAAK,CAAC,MAAM;IAAC;IAG3C,UAAU;IACV,iBAAiB,oIAAA,CAAA,IAAC,CAAC,MAAM;AAC3B,GAAG,MAAM,CACP,CAAC,OAAS,KAAK,QAAQ,KAAK,KAAK,eAAe,EAChD;IACE,SAAS,eAAe,eAAe;IACvC,MAAM;QAAC;KAAkB;AAC3B;AAIK,MAAM,cAAc,oIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;IAClC,OAAO,oIAAA,CAAA,IAAC,CAAC,MAAM,GACZ,KAAK,CAAC;QAAE,SAAS,eAAe,KAAK,CAAC,MAAM;IAAC,GAC7C,MAAM,CACL,CAAC,QAAU,mBAAmB,QAC9B;QAAE,SAAS,eAAe,KAAK,CAAC,MAAM;IAAC;IAG3C,UAAU;AACZ"}},
    {"offset": {"line": 169, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 241, "column": 0}, "map": {"version":3,"sources":["file:///Users/boomthmac/Desktop/kobdemy/nextjs15-basic/src/db/users.ts"],"sourcesContent":["import { prisma } from '@/lib/prisma'\nimport { registerSchema, loginSchema } from '@/lib/schema'\nimport bcrypt from 'bcrypt'\nimport * as jose from 'jose'\nimport { cookies } from 'next/headers'\n\ninterface RegisterInput {\n  name?: string\n  email: string\n  password: string\n  confirmPassword: string\n}\n\ninterface LoginInput {\n  email: string\n  password: string\n}\n\nexport const register = async (input: RegisterInput) => {\n  try {\n    const validated = registerSchema.safeParse(input)\n\n    if (!validated.success) {\n      console.log(validated.error.flatten().fieldErrors)\n      return {\n        message: 'กรุณากรอกข้อมูลให้ถูกต้อง',\n        error: validated.error.flatten().fieldErrors\n      }\n    }\n  \n    const existingUser = await prisma.user.findUnique({\n      where: {\n        email: validated.data.email\n      }\n    })\n  \n    if (existingUser) {\n      return {\n        message: 'อีเมลนี้มีผู้ใช้งานแล้ว'\n      }\n    }\n  \n    const salt = await bcrypt.genSalt(10)\n    const hashedPassword = await bcrypt.hash(validated.data.password, salt)\n  \n    const newUser = await prisma.user.create({\n      data: {\n        name: validated.data.name,\n        email: validated.data.email,\n        password: hashedPassword\n      }\n    })\n  \n    const secret = new TextEncoder().encode(process.env.JWT_SECRET_KEY)\n    const payload = {\n      id: newUser.id\n    }\n    const token = await new jose.SignJWT(payload)\n      .setProtectedHeader({ alg: 'HS256' })\n      .setIssuedAt()\n      .setExpirationTime('1d') // 1 day\n      .sign(secret)\n  \n    const cookie = await cookies()\n    cookie.set('token', token, {\n      httpOnly: true,\n      secure: process.env.NODE_ENV === 'production',\n      maxAge: 60 * 60 * 24 // 1 day\n    })\n  } catch (error) {\n    console.error('Error registration user:', error)\n    return {\n      message: 'เกิดข้อผิดพลาดในการสมัครสมาชิก'\n    }\n  }\n}\n\nexport const login = async (input: LoginInput) => {\n  try {\n    const validated = loginSchema.safeParse(input)\n\n    if (!validated.success) {\n      return {\n        message: 'กรุณากรอกข้อมูลให้ถูกต้อง',\n        error: validated.error.flatten().fieldErrors\n      }\n    }\n\n    const existingUser = await prisma.user.findUnique({\n      where: {\n        email: validated.data.email\n      }\n    })\n\n    if (!existingUser || !await bcrypt.compare(validated.data.password, existingUser.password)) {\n      console.log('user not found')\n      return {\n        message: 'อีเมลหรือรหัสผ่านไม่ถูกต้อง'\n      }\n    }\n\n    const secret = new TextEncoder().encode(process.env.JWT_SECRET_KEY)\n    const payload = {\n      id: existingUser.id\n    }\n    const token = await new jose.SignJWT(payload)\n      .setProtectedHeader({ alg: 'HS256' })\n      .setIssuedAt()\n      .setExpirationTime('1d') // 1 day\n      .sign(secret)\n  \n    const cookie = await cookies()\n    cookie.set('token', token, {\n      httpOnly: true,\n      secure: process.env.NODE_ENV === 'production',\n      maxAge: 60 * 60 * 24 // 1 day\n    })\n  } catch (error) {\n    console.error('Error login user:', error)\n    return {\n      message: 'เกิดข้อผิดพลาดในการเข้าสู่ระบบ' \n    }\n  }\n}\n\n// register({\n//   name: 'Kob',\n//   email: 'kob555@gmail.com',\n//   password: 'Aa112233*',\n//   confirmPassword: 'Aa112233*'\n// })\n\n// login({\n//   email: 'kob555@gmail.com',\n//   password: 'Aa112233*'\n// })"],"names":[],"mappings":"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"}},
    {"offset": {"line": 356, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 362, "column": 0}, "map": {"version":3,"sources":["file:///Users/boomthmac/Desktop/kobdemy/nextjs15-basic/src/app/register/action.ts"],"sourcesContent":["'use server'\n\nimport { register } from '@/db/users'\n\nexport const registerAction = async (\n  prevState: any,\n  formData: FormData\n) => {\n  const rawData = {\n    name: formData.get('name') as string,\n    email: formData.get('email') as string,\n    password: formData.get('password') as string,\n    confirmPassword: formData.get('confirmPassword') as string\n  }\n\n  const result = await register(rawData)\n\n  const response = result?.message ? {\n    success: false,\n    message: result.message,\n    errors: result.error\n  } : {\n    success: true,\n    message: 'สมัครสมาชิกสำเร็จ'\n  }\n\n  return response\n\n  // if (result && result.message) {\n  //   return {\n  //     success: false,\n  //     message: result.message,\n  //     errors: result.error\n  //   }\n  // } else {\n  //   return {\n  //     success: true,\n  //     message: 'สมัครสมาชิกสำเร็จ'\n  //   }\n  // }\n}"],"names":[],"mappings":";;;;;AAEA;;;;;AAEO,MAAM,uCAAY,GAAZ,iBAAiB,OAC5B,WACA;IAEA,MAAM,UAAU;QACd,MAAM,SAAS,GAAG,CAAC;QACnB,OAAO,SAAS,GAAG,CAAC;QACpB,UAAU,SAAS,GAAG,CAAC;QACvB,iBAAiB,SAAS,GAAG,CAAC;IAChC;IAEA,MAAM,SAAS,MAAM,CAAA,GAAA,kHAAA,CAAA,WAAQ,AAAD,EAAE;IAE9B,MAAM,WAAW,QAAQ,UAAU;QACjC,SAAS;QACT,SAAS,OAAO,OAAO;QACvB,QAAQ,OAAO,KAAK;IACtB,IAAI;QACF,SAAS;QACT,SAAS;IACX;IAEA,OAAO;AAEP,kCAAkC;AAClC,aAAa;AACb,sBAAsB;AACtB,+BAA+B;AAC/B,2BAA2B;AAC3B,MAAM;AACN,WAAW;AACX,aAAa;AACb,qBAAqB;AACrB,mCAAmC;AACnC,MAAM;AACN,IAAI;AACN;;;IApCa;;AAAA,+OAAA"}},
    {"offset": {"line": 407, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 413, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 415, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}